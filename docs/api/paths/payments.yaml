/payments/charge:
  post:
    tags:
      - Payment
    summary: 포인트 충전
    description: |
      포인트를 충전합니다.

      **기능 요구사항**: FR-PAY-001
      **관련 문서**: docs/requirements/payment.md

      **비즈니스 규칙**:
      - 충전 금액: 1,000원 ~ 1,000,000원
      - 단위: 1,000원 단위만 가능
      - 최대 보유 잔액: 10,000,000원
      - 현재 잔액 + 충전 금액이 최대 잔액을 초과할 수 없음

      **검증 순서**:
      1. 금액 범위 검증 (1,000 ~ 1,000,000원)
      2. 금액 단위 검증 (1,000원 단위)
      3. 최대 잔액 확인 (락 획득 후 현재 잔액 기준)
    operationId: chargePoints
    parameters:
      - name: userId
        in: query
        description: 사용자 ID
        required: true
        schema:
          type: integer
          example: 1
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/payment.yaml#/components/schemas/ChargePointRequest'
          examples:
            validCharge:
              summary: 정상 충전
              value:
                amount: 50000
            minCharge:
              summary: 최소 금액
              value:
                amount: 1000
            maxCharge:
              summary: 최대 금액
              value:
                amount: 1000000
    responses:
      '200':
        description: 충전 성공
        content:
          application/json:
            schema:
              $ref: '../schemas/payment.yaml#/components/schemas/ChargePointResponse'
      '400':
        description: 잘못된 요청
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/components/schemas/Error'
            examples:
              invalidChargeAmount:
                summary: 유효하지 않은 금액
                value:
                  code: "INVALID_CHARGE_AMOUNT"
                  message: "충전 금액은 1,000원 이상 1,000,000원 이하여야 합니다"
              invalidChargeUnit:
                summary: 유효하지 않은 단위
                value:
                  code: "INVALID_CHARGE_UNIT"
                  message: "충전 금액은 1,000원 단위로만 가능합니다"
              maxBalanceExceeded:
                summary: 최대 잔액 초과
                value:
                  code: "MAX_BALANCE_EXCEEDED"
                  message: "최대 보유 가능 잔액(10,000,000원)을 초과합니다"
                  details:
                    currentBalance: 9800000
                    chargeAmount: 500000
                    maxBalance: 10000000
                    chargeableAmount: 200000
      '500':
        description: 서버 오류

/payments/balance:
  get:
    tags:
      - Payment
    summary: 포인트 잔액 조회
    description: |
      현재 포인트 잔액을 조회합니다.

      **기능 요구사항**: FR-PAY-002
      **관련 문서**: docs/requirements/payment.md
    operationId: getPointBalance
    parameters:
      - name: userId
        in: query
        description: 사용자 ID
        required: true
        schema:
          type: integer
          example: 1
    responses:
      '200':
        description: 조회 성공
        content:
          application/json:
            schema:
              $ref: '../schemas/payment.yaml#/components/schemas/PointBalanceResponse'
      '404':
        description: 사용자 포인트 계정이 없음
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/components/schemas/Error'
            example:
              code: "USER_POINT_NOT_FOUND"
              message: "포인트 계정을 찾을 수 없습니다"
      '500':
        description: 서버 오류

/payments/transactions:
  get:
    tags:
      - Payment
    summary: 포인트 사용 내역 조회
    description: |
      포인트 충전/사용/환불 내역을 조회합니다.

      **기능 요구사항**: FR-PAY-003
      **관련 문서**: docs/requirements/payment.md

      **비즈니스 규칙**:
      - 최신 거래부터 내림차순 정렬
      - 타입별 필터링 가능 (CHARGE, USE, REFUND)
    operationId: getPointTransactions
    parameters:
      - name: userId
        in: query
        description: 사용자 ID
        required: true
        schema:
          type: integer
          example: 1
      - name: type
        in: query
        description: 트랜잭션 타입 필터
        required: false
        schema:
          $ref: '../schemas/payment.yaml#/components/schemas/PointTransactionType'
      - name: page
        in: query
        description: 페이지 번호
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: size
        in: query
        description: 페이지 크기
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
    responses:
      '200':
        description: 조회 성공
        content:
          application/json:
            schema:
              $ref: '../schemas/payment.yaml#/components/schemas/PointTransactionListResponse'
      '500':
        description: 서버 오류
